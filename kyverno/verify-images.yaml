# SPDX-License-Identifier: Apache-2.0
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata: { name: verify-signed-images }
spec:
  validationFailureAction: enforce
  rules:
  - name: require-signed
    match: { resources: { kinds: ["Pod","Deployment"] } }
    verifyImages:
    - imageReferences: ["ghcr.io/*/*"]
      attestors:
      - entries:
        - keyless:
            subject: "mailto:*@users.noreply.github.com"
            issuer: "https://token.actions.githubusercontent.com"
